(()=>{var u,s;var c=class{constructor(o){if(this.ws=null,this.addr=void 0,this.funs={_render:e=>{let n=document.getElementById(e.id);if(!n)return{error:!0,message:"element not found: "+e};n.innerHTML=e.html,console.log(e.html);let l=n.querySelectorAll("[fc]");console.log(l),l.forEach(r=>{if(console.log("ELEM"),console.log(r),!r)return;let d=r.getAttribute("fc");console.log("_FC ATTRIBUTE"),console.log(d),JSON.parse(d).forEach(h=>{let t=h;r.addEventListener(t.on,a=>{a.preventDefault(),console.log("event: "+t.on);let i;if(t.on=="submit"){let w=a.target,g=new FormData(w);i=Object.fromEntries(g.entries()),console.log(i)}let f={function:"event",conn_id:s,target_id:r.id,inner:!1,action:t.action,method:t.method,event:t,data:JSON.stringify(i),message:"event dispatched"};console.log(f),this.ws.send(JSON.stringify(f))})})})},redirect:e=>{let n={function:"redirect",conn_id:s,target_id:e.target_id,inner:!1,action:e.action,method:e.method,event:e.event,data:e.data,message:e.message};this.ws.send(JSON.stringify(n))},render:e=>{console.log(e),this.funs._render({id:e.target_id,inner:e.inner,html:e.data})}},this.addr)throw new Error("ws: already connected to server...");if(!o)throw new Error("ws: no address provided...");this.addr=o,u=this.funs,this.connect(o)}connect(o){try{this.ws=new WebSocket(o)}catch(e){throw new Error("ws: failed to connect to server...")}this.ws.onopen=function(){},this.ws.onclose=function(){},this.ws.onerror=function(e){throw new Error("ws: "+e)},this.ws.onmessage=function(e){let n=JSON.parse(e.data);if(console.log(n),!n)throw new Error("ws: no data received in request...");if(n.function=="_connect"){if(s)return;s=n.conn_id}else{if(!n.function){console.log("ws: error no function provided in request...");return}u[n.function](n)}}}},v=new c("ws://localhost%s/%s/%s");})();
